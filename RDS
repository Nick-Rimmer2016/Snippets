Import-Module RemoteDesktop

Get-command -Module RemoteDesktop

New-RDRemoteApp -CollectionName Applications -DisplayName Accurate -FilePath C:\windows\System32\WindowsPowerShell\v1.0\powershell.exe -CommandLineSetting Require `
-RequiredCommandLine "-ExecutionPolicy ByPass -File c:\scripts\test.ps1" -IconPath C:\Scripts\trash_empty_ico.ico -Alias Accurate

Get-RDRemoteApp -alias "powershell" | fl

# c:\windows\system32\shell32.dll
#Browse to C:\Windows\RemotePackages\CPubFarms\Applications\CPubRemoteApps on the server holding the RD Connection Broker role and you will see all the .ico files. In the example for Windows Update Log I’d remove “notepad.ico” and instead copy a .ico file of my choice and rename it to “notepad.ico”.
#This will replace the icon for the RemoteApp in your Remote Apps and Desktop Connections application on next refresh. For RD Web Access you’ll have to stop and start the Web application on the RD Web Access server.
#This will only work for .ico files. If your icon is in a .exe or .dll you’ll still have to use powershell
Get-RDRemoteApp -Alias "powershell" | Set-RDRemoteApp -IconPath "c:\windows\system32\shell32.dll" -IconIndex 46

#Customise RDWeb
# https://www.rdsgurus.com/working-with-rd-web-access-in-windows-server-2012/
Set-RDWorkspace -Name "NDR IT Solutions" -ConnectionBroker APP1.psdevops.local
